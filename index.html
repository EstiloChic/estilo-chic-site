<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estilo Chic - Moda Feminina</title>
    <meta name="description" content="Descubra a eleg√¢ncia e o charme da moda feminina. Roupas, maquiagens e acess√≥rios selecionados para real√ßar o seu estilo √∫nico.">
    <link rel="icon" href="https://i.postimg.cc/ZqP5v2Cj/ES-2.png" type="image/png">
    
    <!-- Fontes Externas -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Depend√™ncias Externas de Scripts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
    
    <style>
    :root {
        --purple-dark: #6a1b9a;
        --purple-medium: #a855f7;
        --purple-light: #d1c4e9;
        --purple-faint: #f5f3ff; 
        --green-faint: #f0fdf4;
        --green-dark-text: #166534;
        --background-main: #f9f6ff;
        --background-card: #ffffff;
        --text-primary: #3a2d46;
        --text-secondary: #6d5f7a;
        --accent-pink: #ec4899;
        --font-display: 'Poppins', sans-serif;
        --font-body: 'Poppins', sans-serif;
        --shadow-subtle: 0 4px 15px rgba(106, 27, 154, 0.05);
        --shadow-medium: 0 8px 25px rgba(106, 27, 154, 0.1);
    }

    html { scroll-behavior: smooth; scroll-padding-top: 100px; }
    body { background-color: var(--background-main); overflow-x: hidden; font-family: var(--font-body); color: var(--text-primary); -webkit-font-smoothing: antialiased; }

    @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.3); } 100% { transform: scale(1); } }
    @keyframes new-glow { 0% { box-shadow: 0 0 0 rgba(168, 85, 247, 0); } 50% { box-shadow: 0 0 20px 8px rgba(209, 196, 233, 0.7); } 100% { box-shadow: var(--shadow-subtle); } }
    @keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); } 20%, 40%, 60%, 80% { transform: translateX(5px); } }
    @keyframes icon-pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

    .loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--purple-dark); display: flex; align-items: center; justify-content: center; z-index: 9999; transition: opacity 0.8s ease-out, visibility 0.8s; }
    .loading-overlay.hidden { opacity: 0; visibility: hidden; }
    .spinner { width: 40px; height: 40px; border: 3px solid rgba(255,255,255,0.2); border-top-color: white; border-radius: 50%; animation: spin 1s ease-in-out infinite; }

    .header-bg-pattern::before { content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: url(https://www.transparenttextures.com/patterns/diamond-upholstery.png); opacity: 0.1; z-index: 1; mix-blend-mode: overlay; }
    
    #hamburger-button .icon-close { display: none; }
    #hamburger-button.menu-open .icon-menu { display: none; }
    #hamburger-button.menu-open .icon-close { display: block; }

    #mobile-nav { max-height: 0; opacity: 0; overflow: hidden; transform: translateY(-10px); transition: max-height 0.4s ease-in-out, opacity 0.3s ease-in-out, transform 0.3s ease-in-out; }
    #mobile-nav.menu-open { max-height: 500px; opacity: 1; transform: translateY(0); }
    .mobile-social-link { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; background-color: rgba(255, 255, 255, 0.1); transition: all 0.3s ease; }
    .mobile-social-link:hover { background-color: rgba(255, 255, 255, 0.2); transform: scale(1.1); }

    .section-title { font-family: var(--font-display); color: var(--text-primary); font-weight: 700; }
    .section-subtitle { color: var(--text-secondary); max-width: 600px; margin: 0 auto 1.5rem auto; }

    .product { background: var(--background-card); border: 1px solid #e0d8f0; border-radius: 16px; box-shadow: var(--shadow-subtle); transition: transform 0.4s ease, box-shadow 0.4s ease, opacity 0.4s ease; animation: fadeInUp 0.5s ease forwards; opacity: 0; }
    .product:hover:not(.out-of-stock) { transform: translateY(-8px); box-shadow: var(--shadow-medium); }
    .product.new-since-last-visit { animation: new-glow 1.2s ease-out forwards 0.5s, fadeInUp 0.5s ease forwards; }
    
    .product > .relative { border-top-left-radius: 16px; border-top-right-radius: 16px; }
    .product-image { transition: transform 0.5s cubic-bezier(0.22, 1, 0.36, 1), filter 0.4s ease; cursor: pointer; }
    .product:hover:not(.out-of-stock) .product-image { transform: scale(1.05); }
    .product-badge { position: absolute; top: 12px; left: 12px; color: white; padding: 3px 12px; font-size: 0.7rem; font-weight: 500; border-radius: 99px; text-transform: uppercase; background: var(--accent-pink); }
    .toggle-favorite-btn { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(5px); transition: all 0.3s ease; }
    .toggle-favorite-btn:hover { background: white; transform: scale(1.1); }
    .heart-icon { color: var(--purple-light); transition: all 0.3s ease; }
    .heart-icon.active { color: var(--purple-medium); animation: pulse 0.3s ease; }

    .btn { font-family: var(--font-body); font-weight: 600; border-radius: 99px; padding: 0.6rem 1rem; transition: all 0.3s ease; cursor: pointer; text-align: center; font-size: 0.8rem; display: inline-flex; align-items: center; justify-content: center; border: 1.5px solid transparent; width: 100%; }
    .btn-add-default { background-color: var(--purple-faint); color: var(--purple-dark); border-color: var(--purple-light); }
    .btn-add-default:hover { background-color: var(--purple-light); }
    .btn-add-success { background-color: #6a1b9a; color: white; cursor: default; }
    .btn-buy { background-color: var(--green-faint); color: var(--green-dark-text); border-color: #a7f3d0; }
    .btn-buy:hover { background-color: #dcfce7; }
    .btn-outline-purple { background-color: var(--purple-faint); border-color: var(--purple-light); color: var(--purple-dark); }
    .btn-outline-purple:hover { background-color: var(--purple-light); }
    
    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(58, 45, 70, 0.5); backdrop-filter: blur(10px); z-index: 1000; opacity: 0; visibility: hidden; transition: opacity 0.4s ease; }
    .modal-overlay.visible { opacity: 1; visibility: visible; }
    .image-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; z-index: 1999; pointer-events: none; }
    .image-modal-content { background: var(--background-card); border-radius: 16px; box-shadow: var(--shadow-medium); width: 90%; max-width: 500px; pointer-events: auto; overflow: hidden; transform: scale(0.95); transition: transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1); }
    .modal-overlay.visible .image-modal-content { transform: scale(1); }
    .image-modal-content img { display: block; width: 100%; height: auto; max-height: 70vh; object-fit: contain; margin: 0 auto; }
    .close-modal-btn { position: absolute; top: 12px; right: 12px; background: rgba(0, 0, 0, 0.3); color: white; cursor: pointer; border: none; border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; z-index: 2001; }
    .close-modal-btn:hover { background: rgba(0, 0, 0, 0.6); transform: scale(1.1); }

    .floating-buttons-container { position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; align-items: end; gap: 1rem; z-index: 1001; transition: all 0.4s ease; }
    .floating-buttons-container.hidden { opacity: 0; visibility: hidden; transform: translateY(20px); }
    .floating-cart, .floating-favorites { width: 55px; height: 55px; background: var(--purple-dark); box-shadow: var(--shadow-medium); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; cursor: pointer; transition: all 0.3s ease; }
    .floating-cart:hover, .floating-favorites:hover { background: #4a0e6b; transform: scale(1.1); }
    .floating-cart.active, .floating-favorites.active { background-color: var(--purple-dark); }
    .cart-count { position: absolute; top: -2px; right: -2px; background: var(--accent-pink); color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 0.75rem; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 2px solid var(--purple-dark); }
    .floating-cart.shake, .floating-favorites.shake { animation: shake 0.5s ease; }

    .cart-dropdown, .favorites-dropdown { position: fixed; top: 50%; left: 50%; background: var(--background-card); border-radius: 16px; box-shadow: 0 15px 40px rgba(58, 45, 70, 0.2); width: 90%; max-width: 380px; max-height: 80vh; overflow-y: auto; padding: 20px; z-index: 1001; opacity: 0; transform: translate(-50%, -48%) scale(0.95); transition: all 0.3s cubic-bezier(0.165, 0.84, 0.44, 1); border: 1px solid #e0d8f0; visibility: hidden; }
    .cart-dropdown.show, .favorites-dropdown.show { opacity: 1; transform: translate(-50%, -50%) scale(1); visibility: visible; }
    @media (min-width: 768px) { .cart-dropdown, .favorites-dropdown { position: absolute; top: auto; left: auto; transform: translateY(10px) scale(0.95); transition: opacity 0.2s ease, transform 0.2s ease, visibility 0.2s; } .cart-dropdown.show, .favorites-dropdown.show { transform: translateY(0) scale(1); } }
    .cart-item, .favorite-dropdown-item { border-bottom: 1px solid var(--background-main); }
    .cart-item:last-child, .favorite-dropdown-item:last-child { border-bottom: none; }
    
    .icon-btn-circle { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background-color: #fee2e2; color: #ef4444; transition: all 0.2s ease; }
    .icon-btn-circle:hover { background-color: #ef4444; color: white; transform: scale(1.1); }

    .step-item { display: flex; flex-direction: column; align-items: center; text-align: center; }
    .step-icon { background-color: #f3e8ff; color: var(--purple-dark); border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; margin-bottom: 0.75rem; transition: all 0.3s ease; }
    .step-item:hover .step-icon { background-color: var(--purple-dark); color: white; transform: scale(1.1) rotate(5deg); }

    footer { background-color: var(--background-card); border-top: 1px solid #e0d8f0; }
    .footer-social-link { width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--purple-dark); background-color: #f3e8ff; box-shadow: var(--shadow-subtle); transition: all 0.3s ease; }
    .footer-social-link:hover { transform: scale(1.15) translateY(-3px); box-shadow: var(--shadow-medium); color: white; }
    .footer-social-link.instagram:hover { background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%); }
    .footer-social-link.whatsapp:hover { background: #25D366; }

    .feedback-toast { position: fixed; bottom: 30px; right: 100px; background-color: var(--purple-dark); color: white; font-size: 0.875rem; font-weight: 500; padding: 0.5rem 1rem; border-radius: 99px; box-shadow: var(--shadow-medium); opacity: 0; transform: translateY(20px) scale(0.9); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); pointer-events: none; visibility: hidden; z-index: 2000; }
    .feedback-toast.show { opacity: 1; transform: translateY(0) scale(1); visibility: visible; }
    
    #activity-toast { position: fixed; bottom: 20px; left: 20px; right: 100px; background-color: var(--background-card); color: var(--text-secondary); padding: 12px 16px; border-radius: 12px; box-shadow: var(--shadow-medium); border: 1px solid #e0d8f0; z-index: 1500; display: flex; align-items: center; gap: 12px; opacity: 0; transform: translateY(20px); visibility: hidden; transition: all 0.4s cubic-bezier(0.215, 0.61, 0.355, 1); font-size: 0.875rem; }
    #activity-toast.show { opacity: 1; transform: translateY(0); visibility: visible; }
    .animate-icon-pulse { animation: icon-pulse 0.8s ease-in-out; }

    .welcome-popup-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(8px); z-index: 3000; display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: all 0.3s ease; }
    .welcome-popup-overlay.show { opacity: 1; visibility: visible; }
    .welcome-popup { background: var(--background-card); border-radius: 16px; box-shadow: var(--shadow-medium); width: 90%; max-width: 400px; text-align: center; padding: 2.5rem; transform: scale(0.9); transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1); position: relative; }
    .welcome-popup-overlay.show .welcome-popup { transform: scale(1); }
    .close-popup-btn { position: absolute; top: 10px; right: 10px; background: #f1f5f9; color: #64748b; border: none; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s ease; }
    .close-popup-btn:hover { background: #e2e8f0; transform: scale(1.1); }
    
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    
    #search-suggestions { position: absolute; top: calc(100% + 4px); left: 0; right: 0; background-color: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); z-index: 20; max-height: 200px; overflow-y: auto; border: 1px solid #e2e8f0; }
    .suggestion-item { padding: 10px 15px; cursor: pointer; transition: background-color 0.2s ease; font-size: 0.875rem; }
    .suggestion-item:hover { background-color: #f3e8ff; }
    .suggestion-item:not(:last-child) { border-bottom: 1px solid #f1f5f9; }

    .info-icon { cursor: pointer; color: var(--purple-medium); transition: all 0.2s ease; }
    .info-icon:hover { transform: scale(1.2); color: var(--purple-dark); }
    .info-modal-content { background: var(--background-card); border-radius: 16px; box-shadow: var(--shadow-medium); width: 90%; max-width: 450px; pointer-events: auto; transform: scale(0.95); transition: transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1); text-align: left; }
    .modal-overlay.visible .info-modal-content { transform: scale(1); }

    .product.out-of-stock { opacity: 0.7; }
    .product.out-of-stock .product-image { filter: grayscale(80%); cursor: default; }
    .btn-sold-out { background-color: #e2e8f0; color: #718096; border-color: #cbd5e0; cursor: not-allowed !important; width: 100%; }

    .visual-category-link { transition: transform 0.2s ease; text-decoration: none; }
    .visual-category-link:hover { transform: translateY(-4px); }
    .visual-category-link .img-container { border: 3px solid transparent; transition: border-color 0.2s ease; }
    .visual-category-link.active .img-container { border-color: var(--purple-medium); }
    .visual-category-link.active span { color: var(--purple-dark); font-weight: 600; }

    /* Corre√ß√£o para a notifica√ß√£o em telas grandes */
    @media (min-width: 768px) {
        #activity-toast {
            right: auto; /* Impede que a notifica√ß√£o se estique */
            max-width: 450px; /* Define uma largura m√°xima elegante */
        }
    }
</style>
</head>
<body>
    <div class="loading-overlay"><div class="spinner"></div></div>
    
    <div class="bg-[#6a1b9a] relative header-bg-pattern flex items-center justify-center h-[120px]">
        <a href="/" aria-label="P√°gina Inicial" class="relative z-10">
            <img src="https://i.postimg.cc/ZqP5v2Cj/ES-2.png" alt="Logo Estilo Chic" class="h-36 mx-auto w-auto">
        </a>
    </div>

    <header id="main-header" class="bg-[#6a1b9a] shadow-md sticky top-0 z-50">
        <div>
            <div class="max-w-6xl mx-auto flex items-center justify-between p-2 h-14 px-4 gap-3 relative">
                
                <!-- Menu Hamb√∫rguer (s√≥ aparece em telas pequenas) -->
                <button id="hamburger-button" class="md:hidden text-white hover:text-purple-200 transition flex-shrink-0 rounded-md p-1">
                    <i class="ph ph-list text-3xl icon-menu"></i>
                    <i class="ph ph-x text-3xl icon-close"></i>
                </button>

                <!-- Menu de Navega√ß√£o para Desktop (s√≥ aparece em telas grandes) -->
                <nav class="hidden md:flex items-center gap-6">
                    <a href="#categorias" class="text-sm font-medium text-white hover:text-purple-200 transition">Cole√ß√µes</a>
                    <a href="#encomendas" class="text-sm font-medium text-white hover:text-purple-200 transition">Encomendas</a>
                    <a href="#sobre" class="text-sm font-medium text-white hover:text-purple-200 transition">Sobre</a>
                    <a href="#contato" class="text-sm font-medium text-white hover:text-purple-200 transition">Contato</a>
                </nav>
                
                <!-- Barra de Pesquisa -->
                <div class="search-container relative flex-grow md:flex-grow-0 md:max-w-xs">
                     <input type="text" class="w-full pl-4 pr-11 py-2 bg-white text-purple-800 text-sm border-2 border-transparent rounded-full focus:outline-none focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition placeholder:text-purple-400 shadow-sm" placeholder="O que voc√™ procura?" id="search-input">
                     <i id="search-icon" class="ph ph-magnifying-glass text-lg absolute right-4 top-1/2 -translate-y-1/2 text-purple-400 z-10 pointer-events-none"></i>
                     <button id="clear-search-btn" class="absolute right-4 top-1/2 -translate-y-1/2 text-purple-400 hover:text-purple-600 transition hidden" aria-label="Limpar busca">
                         <i class="ph ph-x-circle text-xl pointer-events-none"></i>
                     </button>
                     <div id="search-suggestions" class="hidden"></div>
                </div>
            </div>
        </div>

        <!-- Menu de Navega√ß√£o para Mobile (agora com a classe md:hidden) -->
        <nav id="mobile-nav" class="md:hidden bg-[#6a1b9a] absolute w-full shadow-lg relative header-bg-pattern">
            <a href="#categorias" class="mobile-nav-link group flex items-center text-white text-sm font-medium px-4 py-3 hover:bg-white/10 transition relative z-10"><i class="ph ph-squares-four mr-3 text-lg transition-transform group-hover:scale-110 group-hover:rotate-3"></i>Cole√ß√µes</a>
            <a href="#" id="mobile-favorites-menu-link" class="mobile-nav-link group flex items-center text-white text-sm font-medium px-4 py-3 hover:bg-white/10 transition relative z-10"><i class="ph ph-heart mr-3 text-lg transition-transform group-hover:scale-110 group-hover:rotate-3"></i>Favoritos</a>
            <a href="#" id="mobile-cart-menu-link" class="mobile-nav-link group flex items-center text-white text-sm font-medium px-4 py-3 hover:bg-white/10 transition relative z-10"><i class="ph ph-shopping-cart mr-3 text-lg transition-transform group-hover:scale-110 group-hover:rotate-3"></i>Meu Carrinho</a>
            <a href="#meus-pedidos" class="mobile-nav-link group flex items-center text-white text-sm font-medium px-4 py-3 hover:bg-white/10 transition relative z-10"><i class="ph ph-package mr-3 text-lg transition-transform group-hover:scale-110 group-hover:rotate-3"></i>Meus Pedidos</a>
            <a href="#encomendas" class="mobile-nav-link group flex items-center text-white text-sm font-medium px-4 py-3 hover:bg-white/10 transition relative z-10"><i class="ph ph-magic-wand mr-3 text-lg transition-transform group-hover:scale-110 group-hover:rotate-3"></i>Pedidos Especiais</a>
            <a href="#contato" class="mobile-nav-link group flex items-center text-white text-sm font-medium px-4 py-3 hover:bg-white/10 transition relative z-10"><i class="ph ph-chat-circle-dots mr-3 text-lg transition-transform group-hover:scale-110 group-hover:rotate-3"></i>Contato</a>
            <a href="#sobre" class="mobile-nav-link group flex items-center text-white text-sm font-medium px-4 py-3 hover:bg-white/10 transition relative z-10"><i class="ph ph-info mr-3 text-lg transition-transform group-hover:scale-110 group-hover:rotate-3"></i>Sobre</a>
            <div class="px-4 py-4 border-t border-purple-500/50 relative z-10">
                <div class="flex justify-center gap-6">
                    <a href="https://www.instagram.com/estilochicccc" target="_blank" rel="noopener noreferrer" class="mobile-social-link instagram" aria-label="Instagram">
                        <i class="ph ph-instagram-logo text-2xl"></i>
                    </a>
                    <a href="https://wa.me/5522998802545" target="_blank" rel="noopener noreferrer" class="mobile-social-link whatsapp" aria-label="WhatsApp">
                        <i class="ph ph-whatsapp-logo text-2xl"></i>
                    </a>
                </div>
            </div>
        </nav>
    </header>
    
    <main class="max-w-6xl mx-auto p-4 sm:p-6 lg:p-8 pt-8" id="inicio">
        
        <section class="relative z-20" id="categorias">
            <div class="text-center mb-8">
                 <h1 class="section-title text-3xl md:text-4xl mb-2">Nossas Cole√ß√µes</h1>
                 <p class="section-subtitle text-sm md:text-base">Pe√ßas selecionadas com carinho para real√ßar sua beleza.</p>
            </div>
           
            <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                
                <div id="visual-categories" class="w-full md:w-auto">
                    <div class="flex gap-4 sm:gap-6 overflow-x-auto no-scrollbar pt-2 pb-4 sm:justify-center">
                        <a href="#" class="visual-category-link flex-shrink-0 w-24 text-center group" data-category="all">
                            <div class="img-container w-20 h-20 rounded-full mx-auto flex items-center justify-center bg-white shadow-sm">
                                <i class="ph-fill ph-squares-four text-4xl text-purple-500"></i>
                            </div>
                            <span class="mt-2 block text-sm font-medium text-gray-700">Todos</span>
                        </a>
                        <a href="#" class="visual-category-link flex-shrink-0 w-24 text-center group" data-category="roupas">
                            <div class="img-container w-20 h-20 rounded-full mx-auto overflow-hidden bg-white shadow-sm">
                                <img src="https://i.postimg.cc/VLY3LVyh/roupas-estilo-chic-1.jpg" alt="Roupas" class="w-full h-full object-cover">
                            </div>
                            <span class="mt-2 block text-sm font-medium text-gray-700">Roupas</span>
                        </a>
                        <a href="#" class="visual-category-link flex-shrink-0 w-24 text-center group" data-category="maquiagens">
                            <div class="img-container w-20 h-20 rounded-full mx-auto overflow-hidden bg-white shadow-sm">
                                <img src="https://i.postimg.cc/MKdgcmqp/maquiagem-estilo-chic-1.jpg" alt="Maquiagens" class="w-full h-full object-cover">
                            </div>
                            <span class="mt-2 block text-sm font-medium text-gray-700">Maquiagens</span>
                        </a>
                        <a href="#" class="visual-category-link flex-shrink-0 w-24 text-center group" data-category="acessorios">
                            <div class="img-container w-20 h-20 rounded-full mx-auto overflow-hidden bg-white shadow-sm">
                                <img src="https://i.postimg.cc/x18hLN1y/acessorios-estilo-chic-1.jpg" alt="Acess√≥rios" class="w-full h-full object-cover">
                            </div>
                            <span class="mt-2 block text-sm font-medium text-gray-700">Acess√≥rios</span>
                        </a>
                    </div>
                </div>

                <div class="relative flex-shrink-0" id="sort-dropdown-container">
                    <button id="sort-button" class="flex items-center justify-between bg-white text-gray-700 text-sm px-4 py-2 rounded-full shadow-sm border border-purple-100 focus:outline-none focus:ring-2 focus:ring-purple-400 transition">
                        <span id="sort-button-text" class="whitespace-nowrap">Ordenar: Padr√£o</span>
                        <i id="sort-caret" class="ph ph-caret-down text-purple-600 transition-transform duration-300 ml-2"></i>
                    </button>
                    <div id="sort-options" class="absolute hidden mt-1 w-full bg-white rounded-xl shadow-lg py-1 z-30">
                        <a href="#" class="sort-option block px-4 py-2 text-sm text-gray-700 hover:bg-purple-50" data-value="default">Padr√£o</a>
                        <a href="#" class="sort-option block px-4 py-2 text-sm text-gray-700 hover:bg-purple-50" data-value="price-asc">Menor Pre√ßo</a>
                        <a href="#" class="sort-option block px-4 py-2 text-sm text-gray-700 hover:bg-purple-50" data-value="price-desc">Maior Pre√ßo</a>
                        <a href="#" class="sort-option block px-4 py-2 text-sm text-gray-700 hover:bg-purple-50" data-value="name-asc">Nome (A-Z)</a>
                    </div>
                </div>
            </div>

            <!-- Banner de Frete -->
            <div class="bg-purple-50 border border-purple-200 text-purple-800 rounded-xl p-4 flex items-center gap-4 mb-8 text-sm sm:text-base">
                <i class="ph-fill ph-truck text-3xl text-purple-600"></i>
                <p><strong>Frete gr√°tis</strong> para S√£o Francisco e regi√£o. Para outras localidades, frete a combinar!</p>
                <i class="ph-fill ph-info text-xl ml-auto info-icon open-shipping-info-modal" title="Saiba mais sobre a entrega"></i>
            </div>
        </section>

        <section class="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 sm:gap-4" id="product-grid">
            <!-- Os cards dos produtos ser√£o inseridos aqui pelo JavaScript -->
        </section>
        
        <div id="load-more-container" class="text-center mt-8">
            <!-- O bot√£o ser√° inserido aqui dinamicamente pelo JavaScript -->
        </div>

        <div id="no-products-message" class="text-center py-16 text-gray-600 hidden"></div>
        
        <section id="meus-pedidos" class="bg-white/60 p-6 md:p-8 rounded-2xl shadow-lg mt-12 text-center">
            <h2 class="section-title text-3xl md:text-4xl mb-3">Acompanhe seus Pedidos</h2>
            <p class="section-subtitle text-sm md:text-base mb-8">Fale conosco para saber o status da sua compra.</p>
            <a href="https://wa.me/5522998802545?text=Ol√°!%20Gostaria%20de%20saber%20sobre%20o%20status%20do%20meu%20pedido." target="_blank" class="btn btn-buy py-3 px-8 text-base" style="width: auto;">
                 <i class="ph-fill ph-whatsapp-logo text-xl mr-2"></i> Consultar Pedido
            </a>
        </section>
        
        <section id="encomendas" class="bg-white/60 p-6 md:p-8 rounded-2xl shadow-lg mt-12 text-center">
            <h2 class="section-title text-3xl md:text-4xl mb-3">Sua Ideia, Nossa Cria√ß√£o</h2>
            <p class="section-subtitle text-sm md:text-base mb-8">N√£o encontrou o que sonhava? N√≥s realizamos.</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8 mb-8 max-w-4xl mx-auto">
                <div class="step-item"><div class="step-icon"><i class="ph-fill ph-chat-circle-dots text-2xl"></i></div><div><h4 class="font-bold text-base text-gray-800">1. Inicie a Conversa</h4><p class="text-xs text-gray-600">Nos chame no WhatsApp.</p></div></div>
                <div class="step-item"><div class="step-icon"><i class="ph-fill ph-paint-brush text-2xl"></i></div><div><h4 class="font-bold text-base text-gray-800">2. Descreva sua Ideia</h4><p class="text-xs text-gray-600">Envie detalhes e refer√™ncias.</p></div></div>
                <div class="step-item"><div class="step-icon"><i class="ph-fill ph-package text-2xl"></i></div><div><h4 class="font-bold text-base text-gray-800">3. Receba seu Pedido</h4><p class="text-xs text-gray-600">Produzimos e enviamos.</p></div></div>
            </div>
            <a href="https://wa.me/5522998802545?text=Ol√°!%20Gostaria%20de%20fazer%20um%20or√ßamento%20para%20um%20pedido%20sob%20encomenda." target="_blank" class="btn btn-buy py-3 px-8 text-base" style="width: auto;">
                 <i class="ph-fill ph-whatsapp-logo text-xl mr-2"></i> Pedido Especial
            </a>
        </section>

        <a href="https://www.instagram.com/estilochicccc" target="_blank" rel="noopener noreferrer">
            <section id="instagram" class="bg-white/60 p-6 md:p-10 rounded-2xl shadow-lg mt-12 text-center overflow-hidden">
                <h2 class="section-title text-3xl md:text-4xl mb-2">Siga nosso Estilo</h2>
                <p class="section-subtitle text-sm md:text-base !mb-6">Inspira√ß√µes, novidades e os bastidores do nosso mundo.</p>
                <div class="btn btn-outline-purple py-3 px-8 text-base inline-flex" style="width: auto;">
                    <i class="ph-fill ph-instagram-logo mr-2"></i> @estilochicccc
                </div>
            </section>
        </a>

        <section id="sobre" class="p-6 md:p-12 text-center mt-12">
            <h2 class="section-title text-3xl md:text-4xl mb-4">Sobre N√≥s</h2>
            <div class="w-24 h-1 bg-purple-200 mx-auto my-4 rounded-full"></div>
            <p class="text-base md:text-lg text-gray-700 mb-4 max-w-2xl mx-auto">Na Estilo Chic, acreditamos que a moda √© uma forma de express√£o. Oferecemos pe√ßas que combinam eleg√¢ncia e qualidade, criadas para celebrar o estilo √∫nico que existe em cada mulher.</p>
            <p class="text-purple-700 font-semibold text-base md:text-lg inline-flex items-center gap-2">
                Um universo de variedades para todos os gostos
                <i class="ph-fill ph-heart text-purple-600 text-xl"></i>
            </p>
        </section>
    </main>

    <footer id="contato" class="mt-8">
        <div class="max-w-6xl mx-auto px-4 py-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-center text-center">
                <div class="md:text-left"><h3 class="font-bold font-display text-lg mb-2 text-purple-800">Nossa Inspira√ß√£o</h3><p class="italic text-gray-600 text-sm">"Consagre ao Senhor tudo o que voc√™ faz, e os seus planos ser√£o bem-sucedidos." - Pv 16:3</p></div>
                <div class="flex flex-col items-center"><h3 class="font-bold font-display text-lg text-purple-800 uppercase tracking-widest">Contato</h3><div class="w-16 h-px bg-purple-200 mx-auto mt-2 mb-4"></div><div class="flex justify-center gap-5"><a href="https://www.instagram.com/estilochicccc" target="_blank" rel="noopener noreferrer" class="footer-social-link instagram"><i class="ph ph-instagram-logo text-2xl"></i></a><a href="https://wa.me/5522998802545" target="_blank" rel="noopener noreferrer" class="footer-social-link whatsapp"><i class="ph ph-whatsapp-logo text-2xl"></i></a></div></div>
                <div class="md:text-right"><h3 class="font-bold font-display text-lg mb-2 text-purple-800">Localiza√ß√£o</h3><p class="text-sm text-gray-600">üìç S√£o Francisco de Itabapoana - RJ</p><p class="text-xs text-gray-500 mt-1">Atendemos toda a regi√£o com entregas.</p></div>
            </div>
        </div>
        <div class="bg-purple-50 py-4 text-center text-xs text-purple-800"><p>¬© 2025 Estilo Chic | Todos os direitos reservados.</p></div>
    </footer>
    
    <div id="modal-overlay" class="modal-overlay"></div>
    <div id="product-detail-modal" class="image-modal hidden"></div>
    
    <div id="shipping-info-modal" class="image-modal hidden">
        <div class="info-modal-content p-6 relative">
             <button class="close-modal-btn !bg-gray-200 !text-gray-700" aria-label="Fechar"><i class="ph ph-x"></i></button>
            <h3 class="text-xl font-bold font-display text-purple-800 mb-4">Entenda nossa √Årea de Entrega Gr√°tis</h3>
            <div class="text-sm text-gray-600 space-y-3">
                <p>Nossa mensagem <strong>"S√£o Francisco e regi√£o"</strong> se refere √† nossa principal √°rea de atendimento, onde conseguimos realizar entregas r√°pidas e sem custo!</p>
                <p>Esta √°rea inclui:</p>
                <ul class="list-disc list-inside pl-2 text-purple-700 space-y-1">
                    <li>Todo o munic√≠pio de <strong>S√£o Francisco de Itabapoana, RJ</strong>.</li>
                    <li>Localidades vizinhas pr√≥ximas.</li>
                </ul>
                <p>Se voc√™ mora fora dessa √°rea, n√£o se preocupe! Entre em contato que combinamos a melhor forma de enviar seu pedido at√© voc√™.</p>
            </div>
            <button id="close-shipping-info-btn" class="btn btn-outline-purple w-full mt-6">Entendi!</button>
        </div>
    </div>

    <div id="floating-buttons-container" class="floating-buttons-container">
        <div id="favorites-container" class="relative"><div id="floating-favorites-btn" class="floating-favorites"><i class="ph-fill ph-heart text-2xl"></i><div class="cart-count" style="display: none;"></div></div><div id="favorites-dropdown" class="favorites-dropdown md:absolute md:bottom-full md:right-0 md:mb-2 md:w-80"></div></div>
        <div id="cart-container" class="relative"><div id="floating-cart-btn" class="floating-cart"><i class="ph-fill ph-shopping-cart text-2xl"></i><div class="cart-count" style="display: none;"></div></div><div id="cart-dropdown" class="cart-dropdown md:absolute md:bottom-full md:right-0 md:mb-2 md:w-96"></div></div>
    </div>
    
    <div id="cart-feedback-toast" class="feedback-toast">Adicionado ao carrinho!</div>
    <div id="favorites-feedback-toast" class="feedback-toast" style="bottom: 95px;">Salvo nos favoritos!</div>
    
    <div id="activity-toast"></div>

    <div id="welcome-popup-overlay" class="welcome-popup-overlay"><div class="welcome-popup"><button id="close-popup" class="close-popup-btn"><i class="ph ph-x"></i></button><i class="ph-fill ph-gift text-5xl text-purple-500 mb-3"></i><h2 class="section-title text-2xl mb-2">Um presente para voc√™!</h2><p class="text-gray-600 mb-6">√â sua primeira vez aqui? Ganhe <strong>5% de desconto</strong> no seu primeiro pedido!</p><a href="https://wa.me/5522998802545?text=Ol√°!%20Vim%20pelo%20site%20e%20quero%20meu%20cupom%20de%205%25%20OFF%20de%20boas-vindas!" target="_blank" id="claim-coupon-btn" class="btn btn-buy py-3"><i class="ph-fill ph-whatsapp-logo text-xl mr-2"></i>Resgatar Cupom</a></div></div>
    
    <script>
        let allProducts = [];
        
        function showProductDetailModal(productId) {
            const get = (selector) => document.querySelector(selector);
            const UIElements = { productDetailModal: get('#product-detail-modal'), modalOverlay: get('#modal-overlay') };
            const cart = JSON.parse(localStorage.getItem('estiloChicCart') || '{}');

            const product = allProducts.find(p => p.id === productId);
            if (!product) {
                console.error("Produto n√£o encontrado:", productId);
                return;
            }

            const isInCart = cart[product.id] > 0;
            UIElements.productDetailModal.innerHTML = `
                <div class="image-modal-content">
                    <button class="close-modal-btn" aria-label="Fechar"><i class="ph ph-x"></i></button>
                    <img src="${product.image}" alt="${product.name}">
                    <div class="p-4 sm:p-6 text-left">
                        <h3 class="text-2xl font-bold font-display text-gray-800 mb-2">${product.name}</h3>
                        <p class="text-sm text-gray-600 mb-4">${product.description || ''}</p>
                        
                        <div class="mt-4 p-3 bg-green-50/80 rounded-lg text-sm text-green-800 flex items-center gap-3">
                            <i class="ph-fill ph-truck text-2xl"></i>
                            <div>
                                <strong>Frete gr√°tis para S√£o Francisco e regi√£o.</strong>
                                <span class="block text-xs">Demais localidades, frete a combinar.</span>
                            </div>
                            <i class="ph-fill ph-info text-xl ml-auto info-icon open-shipping-info-modal" title="Saiba mais sobre a entrega"></i>
                        </div>

                        <div class="border-t border-purple-100 my-4"></div>

                        <div class="flex justify-between items-center mt-4">
                            <div class="flex flex-col items-start">
                                <p class="text-3xl font-bold text-purple-700">R$ ${Number(product.price).toFixed(2).replace('.', ',')}</p>
                                <span class="text-lg text-gray-400 line-through -mt-1">R$ ${Number(product.originalPrice).toFixed(2).replace('.',',')}</span>
                            </div>
                            <div class="flex flex-col gap-2 text-sm w-36">
                                <button class="btn ${isInCart ? 'btn-add-success':'btn-add-default'} add-to-cart-btn" data-id="${product.id}">
                                    ${isInCart ? '<i class="ph-bold ph-check mr-1"></i> Adicionado':'Adicionar'}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>`;
            
            UIElements.modalOverlay.classList.add('visible');
            UIElements.productDetailModal.classList.remove('hidden');
        };

        document.addEventListener('DOMContentLoaded', () => {

            const get = (selector) => document.querySelector(selector);
            const getAll = (selector) => document.querySelectorAll(selector);
            
            function debounce(func, delay = 300) { let timeout; return (...args) => { clearTimeout(timeout); timeout = setTimeout(() => { func.apply(this, args); }, delay); }; }

            // A linha abaixo √© preenchida pelo Eleventy durante o build do site.
            allProducts = {{ collections.products | getProductList }};

            let cart = {}; let favorites = []; let cartOpen = false; let favoritesOpen = false; let activeFilter = 'all'; let activeSort = 'default'; let fuse; let cartToastTimeout; let favoritesToastTimeout; let lastVisit;
            
            let currentlyFilteredProducts = [];
            const productsPerPage = 10;
            let numDisplayed = 0;
            let loadMoreBtn;

            const UIElements = { 
                productGrid: get('#product-grid'), 
                cartDropdown: get('#cart-dropdown'), 
                favoritesDropdown: get('#favorites-dropdown'), 
                floatingCartBtn: get('#floating-cart-btn'), 
                floatingFavoritesBtn: get('#floating-favorites-btn'), 
                productDetailModal: get('#product-detail-modal'), 
                shippingInfoModal: get('#shipping-info-modal'), 
                modalOverlay: get('#modal-overlay'), 
                searchInput: get('#search-input'), 
                clearSearchBtn: get('#clear-search-btn'), 
                searchIcon: get('#search-icon'), 
                searchSuggestions: get('#search-suggestions'), 
                noProductsMessage: get('#no-products-message'), 
                loadingOverlay: get('.loading-overlay'), 
                sortDropdownContainer: get('#sort-dropdown-container'), 
                sortOptions: get('#sort-options'), 
                sortCaret: get('#sort-caret'), 
                cartFeedbackToast: get('#cart-feedback-toast'), 
                favoritesFeedbackToast: get('#favorites-feedback-toast'), 
                activityToast: get('#activity-toast'), 
                welcomePopupOverlay: get('#welcome-popup-overlay'), 
                hamburgerButton: get('#hamburger-button'), 
                mobileNav: get('#mobile-nav'), 
                mainHeader: get('#main-header'), 
                floatingButtonsContainer: get('#floating-buttons-container'), 
                scrollObserverTarget: get('#contato'),
                loadMoreContainer: get('#load-more-container'),
                visualCategoryLinks: getAll('.visual-category-link') 
            };

            const saveState = () => { localStorage.setItem('estiloChicCart', JSON.stringify(cart)); localStorage.setItem('estiloChicFavorites', JSON.stringify(favorites)); };
            const loadState = () => { try { const sc = localStorage.getItem('estiloChicCart'); if (sc) cart = JSON.parse(sc) || {}; const sf = localStorage.getItem('estiloChicFavorites'); if (sf) favorites = JSON.parse(sf) || []; } catch { cart = {}; favorites = []; } };
            const closeAllModals = () => { UIElements.modalOverlay.classList.remove('visible'); UIElements.productDetailModal.classList.add('hidden'); UIElements.shippingInfoModal.classList.add('hidden'); if (cartOpen) closeCart(); if (favoritesOpen) closeFavorites(); };
            const closeShippingInfoModal = () => { UIElements.shippingInfoModal.classList.add('hidden'); if (!cartOpen && !favoritesOpen && UIElements.productDetailModal.classList.contains('hidden')) { UIElements.modalOverlay.classList.remove('visible'); } };
            const closeCart = (isChaining = false) => { if (!isChaining && UIElements.shippingInfoModal.classList.contains('hidden')) UIElements.modalOverlay.classList.remove('visible'); cartOpen = false; UIElements.cartDropdown.classList.remove('show'); UIElements.floatingCartBtn.classList.remove('active'); };
            const closeFavorites = (isChaining = false) => { if (!isChaining && UIElements.shippingInfoModal.classList.contains('hidden')) UIElements.modalOverlay.classList.remove('visible'); favoritesOpen = false; UIElements.favoritesDropdown.classList.remove('show'); UIElements.floatingFavoritesBtn.classList.remove('active'); };
            const openCart = () => { if (favoritesOpen) closeFavorites(true); UIElements.modalOverlay.classList.add('visible'); cartOpen = true; UIElements.cartDropdown.classList.add('show'); UIElements.floatingCartBtn.classList.add('active'); };
            const openFavorites = () => { if (cartOpen) closeCart(true); UIElements.modalOverlay.classList.add('visible'); favoritesOpen = true; UIElements.favoritesDropdown.classList.add('show'); UIElements.floatingFavoritesBtn.classList.add('active'); };
            const updateCounters = () => { const c1 = UIElements.floatingCartBtn.querySelector('.cart-count'); const c2 = UIElements.floatingFavoritesBtn.querySelector('.cart-count'); const t = Object.values(cart).reduce((s, q) => s + q, 0); c1.textContent = t; c1.style.display = t > 0 ? 'flex' : 'none'; c2.textContent = favorites.length; c2.style.display = favorites.length > 0 ? 'flex' : 'none'; };
            const renderCart = () => { if (Object.keys(cart).length === 0) { UIElements.cartDropdown.innerHTML = `<div class="text-center p-4"><i class="ph ph-shopping-cart text-4xl text-gray-300 mb-2"></i><p class="font-semibold text-gray-700">Seu carrinho est√° vazio</p></div>`; return; } let h = `<div class="flex justify-between items-center mb-4"><h3 class="font-bold text-lg text-purple-800">Meu Carrinho</h3><button class="clear-cart-btn text-xs bg-red-100 text-red-600 font-semibold hover:bg-red-200 px-3 py-1 rounded-full">Limpar</button></div>`; let t = 0; let w = "Ol√°! Gostaria de encomendar:\n\n"; for (const [i, q] of Object.entries(cart)) { const p = allProducts.find(pr => pr.id === i); if (!p) continue; t += p.price * q; w += `- ${q}x ${p.name}\n`; h += `<div class="cart-item flex items-center gap-4 py-3"><img src="${p.image}" alt="${p.name}" class="w-16 h-16 rounded-lg object-cover"><div class="flex-grow"><p class="font-semibold text-sm text-gray-800">${p.name}</p><div class="flex items-center border border-gray-200 rounded-full mt-1.5" style="width: fit-content;"><button class="decrease-quantity-btn px-2 py-1 text-gray-600 hover:bg-gray-100 transition-colors" data-id="${i}"><i class="ph ph-minus text-base pointer-events-none"></i></button><span class="font-semibold text-gray-800 text-sm px-2 border-l border-r border-gray-200">${q}</span><button class="increase-quantity-btn px-2 py-1 text-gray-600 hover:bg-gray-100 transition-colors" data-id="${i}"><i class="ph ph-plus text-base pointer-events-none"></i></button></div></div><div class="flex flex-col items-end justify-between self-stretch py-1"><p class="text-base font-semibold text-purple-700">R$ ${(p.price*q).toFixed(2).replace('.',',')}</p><button class="remove-item-btn icon-btn-circle" data-id="${i}"><i class="ph ph-trash text-base pointer-events-none"></i></button></div></div>`; } w += `\n*Total: R$ ${t.toFixed(2).replace('.',',')}*`; h += `<div class="mt-4 pt-4 border-t"><div class="flex justify-between items-center font-bold text-lg"><span>Total:</span><span class="text-purple-800">R$ ${t.toFixed(2).replace('.',',')}</span></div><div class="flex items-center justify-center text-xs text-gray-500 mt-3 gap-1"><span>Frete gr√°tis para S√£o Francisco e regi√£o.</span> <i class="ph-fill ph-info info-icon open-shipping-info-modal"></i></div><a href="https://wa.me/5522998802545?text=${encodeURIComponent(w)}" target="_blank" class="btn btn-buy w-full mt-4 py-3"><i class="ph-fill ph-whatsapp-logo mr-2"></i> Finalizar Pedido</a></div>`; UIElements.cartDropdown.innerHTML = h; };
            const renderFavorites = () => { if (favorites.length === 0) { UIElements.favoritesDropdown.innerHTML = `<div class="text-center p-4"><i class="ph ph-heart text-4xl text-gray-300 mb-2"></i><p class="font-semibold text-gray-700">Lista de favoritos vazia.</p></div>`; return; } let h = `<div class="flex justify-between items-center mb-4"><h3 class="font-bold text-lg text-purple-800">Meus Favoritos</h3><button class="clear-favorites-btn text-xs bg-red-100 text-red-600 font-semibold hover:bg-red-200 px-3 py-1 rounded-full">Limpar</button></div>`; favorites.forEach(id => { const p = allProducts.find(pr => pr.id === id); if (!p) return; h += `<div class="favorite-dropdown-item flex items-center gap-4 py-3"><img src="${p.image}" alt="${p.name}" class="w-16 h-16 rounded-lg object-cover"><div class="flex-grow"><p class="font-semibold text-sm">${p.name}</p><p class="text-xs text-purple-600 font-medium">R$ ${Number(p.price).toFixed(2).replace('.',',')}</p></div><div class="flex items-center gap-2"><button class="add-to-cart-from-fav-btn icon-btn-circle bg-purple-100 text-purple-700 hover:bg-purple-600" data-id="${id}"><i class="ph ph-shopping-cart-simple pointer-events-none"></i></button><button class="remove-from-favorites-btn icon-btn-circle" data-id="${id}"><i class="ph ph-trash text-base pointer-events-none"></i></button></div></div>`; }); UIElements.favoritesDropdown.innerHTML = h; };
            const updateProductCardStates = () => { getAll('#product-grid .product').forEach(c => { const id = c.dataset.id; const i = cart[id] > 0; const b = c.querySelector('.add-to-cart-btn'); if (b) { b.innerHTML = i ? `<i class="ph-bold ph-check mr-1"></i> Adicionado` : 'Adicionar'; b.classList.remove('btn-add-default', 'btn-add-success'); b.classList.add(i ? 'btn-add-success' : 'btn-add-default'); } const f = c.querySelector('.heart-icon'); if (f) f.classList.toggle('active', favorites.includes(id)); }); };
            const updateApp = () => { saveState(); updateCounters(); renderCart(); renderFavorites(); updateProductCardStates(); };
            
            const createProductCardHTML = (product) => {
                const isInCart = cart[product.id] > 0;
                const whatsAppURL = `https://wa.me/5522998802545?text=${encodeURIComponent(`Ol√°! Tenho interesse no produto: ${product.name}`)}`;
                const isNew = lastVisit && (new Date(product.dateAdded).getTime() > lastVisit);
                const isOutOfStock = product.inStock === false;

                const priceHTML = `
                    <div class="flex items-baseline justify-center flex-nowrap gap-2 mb-2">
                        <span class="text-gray-500 line-through whitespace-nowrap">R$ ${Number(product.originalPrice).toFixed(2).replace('.',',')}</span>
                        <span class="text-purple-700 font-bold text-xl whitespace-nowrap">R$ ${Number(product.price).toFixed(2).replace('.',',')}</span>
                    </div>`;
                const paymentHTML = `<div class="text-[11px] text-gray-500 mb-3"><span>Dinheiro e Pix</span></div>`;

                const buttonsHTML = isOutOfStock
                  ? `<div class="mt-auto pt-4">
                       <button class="btn btn-sold-out" disabled><i class="ph ph-x-circle mr-2"></i>Esgotado</button>
                     </div>`
                  : `<div class="mt-auto">
                       ${priceHTML}
                       ${paymentHTML}
                       <div class="flex flex-col gap-2 text-sm">
                           <button class="btn ${isInCart ? 'btn-add-success' : 'btn-add-default'} add-to-cart-btn" data-id="${product.id}">
                               ${isInCart ? '<i class="ph-bold ph-check mr-1"></i> Adicionado' : 'Adicionar'}
                           </button>
                           <a href="${whatsAppURL}" target="_blank" class="btn btn-buy">Comprar</a>
                       </div>
                     </div>`;
                
                return `
                <div class="product flex flex-col group ${isOutOfStock ? 'out-of-stock' : ''} ${isNew ? 'new-since-last-visit' : ''}" data-id="${product.id}" data-category="${product.category}" tabindex="0">
                    <div class="relative overflow-hidden">
                        <img loading="lazy" src="${product.image}" alt="${product.name}" class="product-image w-full h-48 sm:h-64 object-cover" ${!isOutOfStock ? `onclick="showProductDetailModal('${product.id}')"` : ''}>
                        ${product.badge ? `<div class="product-badge">${product.badge.text}</div>` : ''}
                        <div class="absolute top-3 right-3">
                            <button class="toggle-favorite-btn w-10 h-10 rounded-full flex items-center justify-center" data-id="${product.id}">
                                <i class="heart-icon ph-fill ph-heart text-2xl pointer-events-none"></i>
                            </button>
                        </div>
                        ${!isOutOfStock ? `<div id="viewing-info-${product.id}" class="absolute bottom-2 left-2 h-5"></div>` : ''}
                    </div>
                    <div class="p-3 flex flex-col flex-grow text-center">
                        <h3 class="text-base font-semibold text-gray-800 truncate mb-1">${product.name}</h3>
                        <p class="text-xs text-gray-500 min-h-[16px] mb-3">${product.size ? `Tamanho: ${product.size}` : '&nbsp;'}</p>
                        ${buttonsHTML}
                    </div>
                </div>`;
            };
            
            function displayMoreProducts() {
                const productsToDisplay = currentlyFilteredProducts.slice(numDisplayed, numDisplayed + productsPerPage);

                if (productsToDisplay.length === 0 && numDisplayed === 0) {
                    UIElements.noProductsMessage.classList.remove('hidden');
                    UIElements.noProductsMessage.innerHTML = `<i class="ph ph-flower-lotus text-5xl text-purple-300 mb-4"></i><p class="font-semibold text-xl font-display">Nenhum tesouro encontrado</p><p class="text-gray-500">Tente buscar por outro termo ou alterar os filtros.</p>`;
                    if (loadMoreBtn) loadMoreBtn.classList.add('hidden');
                    return;
                }

                const productsHTML = productsToDisplay.map((product, index) => {
                    const cardHTML = createProductCardHTML(product);
                    const tempDiv = document.createElement('div');
                    tempDiv.innerHTML = cardHTML.trim();
                    const productElement = tempDiv.firstChild;
                    productElement.style.animationDelay = `${(numDisplayed + index) * 60}ms`;
                    return productElement.outerHTML;
                }).join('');

                UIElements.productGrid.insertAdjacentHTML('beforeend', productsHTML);
                numDisplayed += productsToDisplay.length;
                updateProductCardStates();

                if (!loadMoreBtn) {
                    UIElements.loadMoreContainer.innerHTML = `<button id="load-more-btn" class="btn btn-outline-purple px-8 py-3" style="width: auto;">Ver mais</button>`;
                    loadMoreBtn = get('#load-more-btn');
                    loadMoreBtn.addEventListener('click', displayMoreProducts);
                }

                if (numDisplayed >= currentlyFilteredProducts.length) {
                    loadMoreBtn.classList.add('hidden');
                } else {
                    loadMoreBtn.classList.remove('hidden');
                }
            }

            const renderProducts = () => {
                const searchTerm = UIElements.searchInput.value.trim();
                let filteredProducts = [...allProducts];

                if (activeFilter !== 'all') {
                    filteredProducts = filteredProducts.filter(p => p.category === activeFilter);
                }
                if (searchTerm) {
                    const results = fuse.search(searchTerm);
                    const resultIds = new Set(results.map(r => r.item.id));
                    filteredProducts = filteredProducts.filter(p => resultIds.has(p.id));
                }

                if (activeSort === 'price-asc') filteredProducts.sort((a, b) => a.price - b.price);
                else if (activeSort === 'price-desc') filteredProducts.sort((a, b) => b.price - a.price);
                else if (activeSort === 'name-asc') filteredProducts.sort((a, b) => a.name.localeCompare(b.name));

                UIElements.productGrid.innerHTML = '';
                UIElements.noProductsMessage.classList.add('hidden');
                numDisplayed = 0;
                currentlyFilteredProducts = filteredProducts;
                
                displayMoreProducts();
            };

            const updateVisuals = () => { allProducts.forEach(p => { const e = get(`#viewing-info-${p.id}`); if (e) { if (Math.random() > 0.7) p.viewing = Math.max(0, (p.viewing || 0) + (Math.floor(Math.random() * 3) - 1)); if (p.viewing > 0) { e.innerHTML = `<div class="flex items-center gap-1 text-white text-xs font-medium bg-black/40 px-2 py-0.5 rounded-full backdrop-blur-sm animate-pulse"><i class="ph-fill ph-eye text-sm"></i><span>${p.viewing}</span></div>`; } else { e.innerHTML = ''; } } }); };
            const showFeedbackToast = (type) => { const t = type === 'cart' ? UIElements.cartFeedbackToast : UIElements.favoritesFeedbackToast; let to = type === 'cart' ? cartToastTimeout : favoritesToastTimeout; clearTimeout(to); t.classList.add('show'); to = setTimeout(() => t.classList.remove('show'), 2000); if (type === 'cart') cartToastTimeout = to; else favoritesToastTimeout = to; };
            const flyToCart = (target) => { const c = target.closest('.product, .favorite-dropdown-item'); if (!c) return; const i = c.querySelector('img'); if(!i) return; const fi = i.cloneNode(true); const r1 = i.getBoundingClientRect(); const r2 = UIElements.floatingCartBtn.getBoundingClientRect(); fi.style.cssText = `position: fixed; z-index: 9999; left: ${r1.left}px; top: ${r1.top}px; width: ${r1.width}px; height: ${r1.height}px; border-radius: 0.5rem; transition: all 0.7s cubic-bezier(0.5, 0, 0.75, 0.2);`; document.body.appendChild(fi); requestAnimationFrame(() => { fi.style.left = `${r2.left + r2.width / 2 - 20}px`; fi.style.top = `${r2.top + r2.height / 2 - 20}px`; fi.style.width = '40px'; fi.style.height = '40px'; fi.style.transform = 'scale(0.2) rotate(180deg)'; fi.style.opacity = '0'; }); setTimeout(() => { fi.remove(); UIElements.floatingCartBtn.classList.add('shake'); setTimeout(() => UIElements.floatingCartBtn.classList.remove('shake'), 500); }, 700); };
            const setupWelcomePopup = () => { const o = UIElements.welcomePopupOverlay; if (!o) return; const c = () => { o.classList.remove('show'); localStorage.setItem('estiloChicVisitedBefore', 'true'); }; if (!localStorage.getItem('estiloChicVisitedBefore')) setTimeout(() => o.classList.add('show'), 5000); get('#close-popup').addEventListener('click', c); get('#claim-coupon-btn').addEventListener('click', c); o.addEventListener('click', (e) => { if (e.target === o) c(); }); };
            const hideSearchSuggestions = () => { if (UIElements.searchSuggestions) { UIElements.searchSuggestions.classList.add('hidden'); UIElements.searchSuggestions.innerHTML = ''; } };
            const showSearchSuggestions = (term) => { if (!UIElements.searchSuggestions || term.trim() === '') return hideSearchSuggestions(); const results = fuse.search(term).slice(0, 5); if (results.length === 0) return hideSearchSuggestions(); UIElements.searchSuggestions.innerHTML = results.map(({ item }) => `<div class="suggestion-item" data-name="${item.name}"><span>${item.name}</span></div>`).join(''); UIElements.searchSuggestions.classList.remove('hidden'); };
            const resetAllFilters = () => { activeFilter = 'all'; UIElements.searchInput.value = ''; getAll('.visual-category-link').forEach(link => link.classList.remove('active')); get('.visual-category-link[data-category="all"]').classList.add('active'); hideSearchSuggestions(); renderProducts(); checkButtonsVisibility(); };
            const checkButtonsVisibility = () => { const hasText = UIElements.searchInput.value.trim() !== ''; if(UIElements.clearSearchBtn) UIElements.clearSearchBtn.classList.toggle('hidden', !hasText); if(UIElements.searchIcon) UIElements.searchIcon.classList.toggle('hidden', hasText); };
            const setupActivityNotifications = () => { const toast = UIElements.activityToast; if (!toast || allProducts.length === 0) return; const names = ['Ana', 'Mariana', 'J√∫lia', 'Beatriz', 'Larissa', 'Maria', 'Alice', 'Helena', 'Laura', 'Manuela', 'Valentina', 'Sophia', 'Isabella', 'L√≠via', 'Giovanna', 'Yasmin', 'Elo√°', 'Clara', 'Cec√≠lia', 'Liz', 'Mait√™', 'Antonella', 'Elisa', 'Gabriela', 'Luiza', 'Amanda', 'Bruna', 'Camila', 'Fernanda', 'Patr√≠cia', 'Sandra', 'J√©ssica', 'Let√≠cia', 'Aline']; const cities = [ 'S√£o Francisco de Itabapoana', 'Campos dos Goytacazes', 'Maca√©', 'Itaperuna', 'Rio de Janeiro' ]; const actions = [ { verb: 'acabou de comprar', icon: 'ph-fill ph-shopping-cart-simple', color: 'var(--purple-dark)' }, { verb: 'salvou nos favoritos', icon: 'ph-fill ph-heart', color: 'var(--accent-pink)' } ]; const showRandom = () => { if (document.hidden || allProducts.length === 0) return; const name = names[Math.floor(Math.random() * names.length)]; const city = cities[Math.floor(Math.random() * cities.length)]; const action = actions[Math.floor(Math.random() * actions.length)]; const product = allProducts[Math.floor(Math.random() * allProducts.length)]; toast.innerHTML = `<div class="flex-shrink-0 flex items-center justify-center w-10 h-10 rounded-full animate-icon-pulse" style="background-color: ${action.color};"><i class="${action.icon} text-white text-xl"></i></div><div><p><strong>${name}</strong> de ${city}</p><p class="text-sm" style="color: var(--text-secondary);">${action.verb} um(a) <strong>${product.name}</strong></p></div>`; toast.classList.add('show'); setTimeout(() => { toast.classList.remove('show'); }, 5000); }; const startCycle = () => { const delay = Math.random() * (20000 - 8000) + 8000; setTimeout(() => { showRandom(); startCycle(); }, delay); }; setTimeout(startCycle, 7000); };
            const setupObservers = () => { const observer = new IntersectionObserver((entries) => { entries.forEach(entry => { UIElements.floatingButtonsContainer.classList.toggle('hidden', entry.isIntersecting); }); }, { threshold: 0.1 }); if (UIElements.scrollObserverTarget) { observer.observe(UIElements.scrollObserverTarget); } };
            
            function setupEventListeners() {
                UIElements.hamburgerButton.addEventListener('click', () => { UIElements.hamburgerButton.classList.toggle('menu-open'); UIElements.mobileNav.classList.toggle('menu-open'); });
                UIElements.modalOverlay.addEventListener('click', (e) => { if (e.target === UIElements.modalOverlay) closeAllModals(); });
                
                document.body.addEventListener('click', (e) => {
                    const target = e.target;
                    let stateChanged = false;

                    if (target.closest('.open-shipping-info-modal')) { UIElements.modalOverlay.classList.add('visible'); UIElements.shippingInfoModal.classList.remove('hidden'); return; }
                    if (target.closest('#shipping-info-modal .close-modal-btn') || target.closest('#close-shipping-info-btn')) { closeShippingInfoModal(); return; }
                    if (target.closest('#product-detail-modal .close-modal-btn')) { closeAllModals(); return; }
                                        
                    if (!target.closest('.search-container')) hideSearchSuggestions();
                    if (!target.closest('#sort-dropdown-container')) { UIElements.sortOptions.classList.add('hidden'); UIElements.sortCaret.classList.remove('rotate-180'); }
                    
                    if (target.closest('.add-to-cart-btn') && !target.closest('.btn-add-success')) { flyToCart(target); cart[target.dataset.id] = (cart[target.dataset.id] || 0) + 1; showFeedbackToast('cart'); stateChanged = true; }
                    if (target.closest('.add-to-cart-from-fav-btn')) { flyToCart(target); cart[target.dataset.id] = (cart[target.dataset.id] || 0) + 1; showFeedbackToast('cart'); stateChanged = true; }
                    if (target.closest('.toggle-favorite-btn')) { const id = target.closest('.toggle-favorite-btn').dataset.id; const i = favorites.indexOf(id); if (i > -1) favorites.splice(i, 1); else { favorites.push(id); showFeedbackToast('favorites'); UIElements.floatingFavoritesBtn.classList.add('shake'); setTimeout(() => UIElements.floatingFavoritesBtn.classList.remove('shake'), 500); } stateChanged = true; }
                    
                    const id = target.dataset.id;
                    if (target.matches('.increase-quantity-btn') || target.closest('.increase-quantity-btn')) { cart[id || target.closest('.increase-quantity-btn').dataset.id]++; stateChanged = true; }
                    if (target.matches('.decrease-quantity-btn') || target.closest('.decrease-quantity-btn')) { const btnId = id || target.closest('.decrease-quantity-btn').dataset.id; cart[btnId]--; if (cart[btnId] <= 0) delete cart[btnId]; stateChanged = true; }
                    if (target.matches('.remove-item-btn') || target.closest('.remove-item-btn')) { delete cart[id || target.closest('.remove-item-btn').dataset.id]; stateChanged = true; }
                    if (target.matches('.remove-from-favorites-btn') || target.closest('.remove-from-favorites-btn')) { const i = favorites.indexOf(id || target.closest('.remove-from-favorites-btn').dataset.id); if (i > -1) favorites.splice(i, 1); stateChanged = true; }
                    if (target.matches('.clear-cart-btn')) { cart = {}; closeCart(); stateChanged = true; } 
                    if (target.matches('.clear-favorites-btn')) { favorites = []; closeFavorites(); stateChanged = true; }
                    
                    if (target.matches('.mobile-nav-link')) {
                        UIElements.hamburgerButton.click();
                        if (target.id === 'mobile-favorites-menu-link') { e.preventDefault(); openFavorites(); }
                        if (target.id === 'mobile-cart-menu-link') { e.preventDefault(); openCart(); }
                    }
                    if (target.closest('#floating-cart-btn')) { cartOpen ? closeCart() : openCart(); }
                    if (target.closest('#floating-favorites-btn')) { favoritesOpen ? closeFavorites() : openFavorites(); }
                    if (target.closest('#sort-button')) { UIElements.sortOptions.classList.toggle('hidden'); UIElements.sortCaret.classList.toggle('rotate-180'); }
                    if (target.closest('.suggestion-item')) { UIElements.searchInput.value = target.closest('.suggestion-item').dataset.name; hideSearchSuggestions(); renderProducts(); checkButtonsVisibility();}
                    if (UIElements.mobileNav.classList.contains('menu-open') && !target.closest('#main-header')) { UIElements.hamburgerButton.click(); }
                    
                    if (stateChanged) updateApp();
                });
                
                const debouncedRender = debounce(() => renderProducts(), 350);
                UIElements.searchInput.addEventListener('input', () => { showSearchSuggestions(UIElements.searchInput.value); debouncedRender(); checkButtonsVisibility(); });
                UIElements.searchInput.addEventListener('focus', () => showSearchSuggestions(UIElements.searchInput.value));
                if (UIElements.clearSearchBtn) UIElements.clearSearchBtn.addEventListener('click', resetAllFilters);
                
                UIElements.visualCategoryLinks.forEach(link => {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        UIElements.visualCategoryLinks.forEach(l => l.classList.remove('active'));
                        this.classList.add('active');
                        activeFilter = this.dataset.category;
                        renderProducts();
                    });
                });
                getAll('.sort-option').forEach(o => o.addEventListener('click', (e) => { e.preventDefault(); get('#sort-button-text').textContent = `Ordenar: ${o.textContent}`; activeSort = o.dataset.value; getAll('.sort-option').forEach(opt => opt.classList.remove('font-bold')); o.classList.add('font-bold'); UIElements.sortOptions.classList.add('hidden'); UIElements.sortCaret.classList.remove('rotate-180'); renderProducts(); }));
            }

            function init() {
                lastVisit = localStorage.getItem('estiloChicLastVisit');
                localStorage.setItem('estiloChicLastVisit', new Date().getTime());
                
                loadState();
                
                if (Array.isArray(allProducts)) {
                    allProducts.forEach(p => p.viewing = 0);
                    fuse = new Fuse(allProducts, { keys: ['name', 'category', 'description'], threshold: 0.4 });
                } else {
                    console.error("allProducts n√£o √© um array. Verifique o build.", allProducts);
                    allProducts = []; 
                }

                setupEventListeners();
                setupObservers();
                
                get('.visual-category-link[data-category="all"]').classList.add('active');
                get('.sort-option[data-value="default"]').classList.add('font-bold');
                
                renderProducts(); 
                updateApp();
                checkButtonsVisibility();
                setupWelcomePopup();
                setupActivityNotifications();
                
                setInterval(updateVisuals, 4000);
                
                UIElements.loadingOverlay.classList.add('hidden');
            }
            
            init();
        });
    </script>
</body>
</html>
